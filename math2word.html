<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>LaTeX sang Word Equation</title>
<script src="https://cdn.jsdelivr.net/npm/latex2mathml@2.4.1/latex2mathml.min.js"></script>
<style>
body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; }
textarea { width: 100%; height: 200px; margin-bottom: 10px; }
button { padding: 10px 20px; font-size: 16px; }
</style>
</head>
<body>

<h2>Chuyển LaTeX sang Word Equation</h2>
<textarea id="math-input">$2^{x+1} = 8^{x-2}$</textarea><br>
<button id="btn-export">Tải file Word Equation</button>

<script>
document.getElementById('btn-export').addEventListener('click', function(){
    let latex = document.getElementById('math-input').value.trim();
    if (!latex) { alert("Vui lòng nhập LaTeX"); return; }

    // Chuyển LaTeX → MathML
    let mathml = latex2mathml(latex);

    // Word 2003 XML đầy đủ
    let wordXml =
`<?xml version="1.0" encoding="UTF-8"?>
<?mso-application progid="Word.Document"?>
<w:wordDocument xmlns:w="http://schemas.microsoft.com/office/word/2003/wordml"
                xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math"
                xmlns:aml="http://schemas.microsoft.com/aml/2001/core"
                xmlns:wx="http://schemas.microsoft.com/office/word/2003/auxHint"
                xmlns:o="urn:schemas-microsoft-com:office:office"
                xmlns:v="urn:schemas-microsoft-com:vml">
<w:body>
<w:p>
${mathml}
</w:p>
</w:body>
</w:wordDocument>`;

    // Tạo blob để tải
    let blob = new Blob([wordXml], { type: 'application/msword' });
    let url = URL.createObjectURL(blob);

    // Tạo link tải và click
    let a = document.createElement('a');
    a.href = url;
    a.download = 'BaiToan.doc';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    // Giải phóng bộ nhớ
    URL.revokeObjectURL(url);
});
</script>

</body>
</html>
